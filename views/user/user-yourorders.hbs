<section id="page-title" class="page-title">
    <div class="my-account-area">
        <div class="container">
            <div class="row">
                {{>user-ordersnav}}
                <div class="col-md-9">
                    <div class="personal-information">
                        <h4 class="my-account-title">Your Orders</h4>
                        <div class="personal-information-box">
                            <div class="row">
                                {{!-- Tabs For Displaying --}}
                                <div class="product-tabs">
                                    <ul class="nav nav-tabs text-center" role="tablist">
                                        <li role="presentation" class="active">
                                            <a href="#placedBuynow" aria-controls="description" role="tab"
                                                data-toggle="tab">Placed Orders</a>
                                        </li>
                                        <li role="presentation">
                                            <a href="#shippedBuynow" aria-controls="details" role="tab"
                                                data-toggle="tab">Shipped Orders</a>
                                        </li>

                                        <li role="presentation">
                                            <a href="#deliveredBuynow" aria-controls="reviews" role="tab"
                                                data-toggle="tab">Delivered Orders</a>
                                        </li>

                                        <li role="presentation">
                                            <a href="#cancelBuynow" aria-controls="reviews" role="tab"
                                                data-toggle="tab">Cancelled Orders</a>
                                        </li>

                                    </ul>
                                    <div>

                                        <div class="tab-content">
                                            {{#if orders}}
                                            <div role="tabpanel" class="tab-pane" id="pendingBuynow">
                                                {{#each orders}}
                                                {{#eq this.mode 'buynow'}}
                                                {{#eq this.status 'pending'}}
                                                <div class="gallery" style="display: inline;">
                                                    <div class="content">
                                                        <img src="/uploads/{{this.productId}}__1.jpg"
                                                            style="width: 100%;" class="card-img-top" alt="...">
                                                        <a href="/productview/{{this.productId}}" class="productview">
                                                            <h5 class="card-title ">{{this.productName}}</h5>
                                                        </a>
                                                        <h3>₹ <span style="color: red;">{{this.productprice}}</span>
                                                        </h3>


                                                        <p>Order Date : <span style="color: red;">{{this.orderDate}}</span></p>
                                                        <button class="buy-1" style="color: white;margin-bottom: 5px;"
                                                            onclick="cancelOrderBuyNow('{{this._id}}','{{this.productId}}')">Cancel
                                                            Order</button>

                                                    </div>
                                                </div>
                                                {{/eq}}
                                                {{else}}

                                                {{#each this.products}}
                                                {{#eq this.status 'pending'}}
                                                <div class="gallery" style="display: inline;">
                                                    <div class="content">
                                                        <img src="/uploads/{{this.item}}__1.jpg" style="width: 100%;"
                                                            class="card-img-top" alt="...">
                                                        <a href="/productview/{{this.item}}" class="productview">
                                                            <h5 class="card-title ">{{this.name}}</h5>
                                                        </a>
                                                        <h3>₹ <span style="color: red;">{{this.price}}</span></h3>
                                                        <p>Order Date : <span style="color: red;">{{this.orderDate}}</span></p>
                                                        <button class="buy-1"
                                                            onclick="cancelCartOrder('{{this.item}}','{{../this._id}}','{{this.quantity}}')">Cancel
                                                            Order</button>
                                                    </div>
                                                </div>
                                                {{/eq}}
                                                {{/each}}
                                                {{/eq}}
                                                {{/each}}

                                            </div>


                                            {{!-- Placed --}}
                                            <div role="tabpanel" class="tab-pane" id="placedBuynow">
                                                {{#each orders}}
                                                {{#eq this.mode 'buynow'}}
                                                {{#eq this.status 'placed'}}
                                                <div class="gallery" style="display: inline;">
                                                    <div class="content">
                                                        <img src="/uploads/{{this.productId}}__1.jpg"
                                                            style="width: 100%;" class="card-img-top" alt="...">
                                                        <a href="/productview/{{this.productId}}" class="productview">
                                                            <h5 class="card-title ">{{this.productName}}</h5>
                                                        </a>
                                                        <h3>₹ <span style="color: red;">{{this.productprice}}</span>
                                                        </h3>

                                                        <p>Order Date : <span style="color: red;">{{this.orderDate}}</span></p>
                                                        <button class="buy-1" style="color: white;margin-bottom: 5px;"
                                                            onclick="cancelOrderBuyNow('{{this._id}}','{{this.productId}}')">Cancel
                                                            Order</button>
                                                    </div>
                                                </div>
                                                {{!-- Error image --}}
                                                {{else}}
                                                {{/eq}}
                                                <img src="" alt="">
                                                {{else}}
                                                {{#each this.products}}
                                                {{#eq this.status 'placed'}}
                                                <div class="gallery" style="display: inline;">
                                                    <div class="content">
                                                        <img src="/uploads/{{this.item}}__1.jpg" style="width: 100%;"
                                                            class="card-img-top" alt="...">
                                                        <a href="/productview/{{this.item}}" class="productview">
                                                            <h5 class="card-title ">{{this.name}}</h5>
                                                        </a>
                                                        <h3>₹ <span style="color: red;">{{this.price}}</span></h3>
                                                    <p>Order Date : <span style="color: red;">{{this.orderDate}}</span></p>
                                                        <button class="buy-1"
                                                            onclick="cancelCartOrder('{{this.item}}','{{../this._id}}','{{this.quantity}}')">Cancel
                                                            Order</button>

                                                    </div>
                                                </div>
                                                {{else}}
                                                {{!-- Error Image --}}
                                                <img src="" alt="">
                                                {{/eq}}

                                                {{/each}}
                                                {{/eq}}
                                                {{/each}}
                                            </div>


                                            {{!--Shipped Orders --}}
                                            <div role="tabpanel" class="tab-pane" id="shippedBuynow">
                                                {{#each orders}}
                                                {{#eq this.mode 'buynow'}}
                                                {{#eq this.status 'shipped'}}
                                                <div class="gallery" style="display: inline;">
                                                    <div class="content">
                                                        <img src="/uploads/{{this.productId}}__1.jpg"
                                                            style="width: 100%;" class="card-img-top" alt="...">
                                                        <a href="/productview/{{this.productId}}" class="productview">
                                                            <h5 class="card-title ">{{this.productName}}</h5>
                                                        </a>
                                                        <h3>₹ <span style="color: red;">{{this.productprice}}</span>
                                                        </h3>

                                                        <p>Order Date : <span style="color: red;">{{this.orderDate}}</span></p>
                                                        </p>
                                                        <button class="buy-1" style="color: white;margin-bottom: 5px;"
                                                            onclick="cancelOrderBuyNow('{{this._id}}','{{this.productId}}')">Cancel
                                                            Order</button>
                                                    </div>
                                                </div>
                                                {{else}}
                                                {{!-- Error Image --}}
                                                <img src="" alt="">
                                                {{/eq}}
                                                {{else}}
                                                {{#each this.products}}
                                                {{#eq this.status 'shipped'}}
                                                <div class="gallery" style="display: inline;">
                                                    <div class="content">
                                                        <img src="/uploads/{{this.item}}__1.jpg" style="width: 100%;"
                                                            class="card-img-top" alt="...">
                                                        <a href="/productview/{{this.item}}" class="productview">
                                                            <h5 class="card-title ">{{this.name}}</h5>
                                                        </a>
                                                        <h3>₹ <span style="color: red;">{{this.price}}</span></h3>
                                                        <p>Order Date : <span style="color: red;">{{this.orderDate}}</span></p>
                                                        <button class="buy-1" onclick="cancelCartOrder('{{this.item}}','{{../this._id}}','{{this.quantity}}')">Cancel Order</button>

                                                    </div>
                                                </div>
                                                {{else}}
                                                {{!-- Error Image --}}
                                                <img src="" alt="">
                                                {{/eq}}
                                                {{/each}}
                                                {{/eq}}
                                                {{/each}}
                                            </div>




                                            <div role="tabpanel" class="tab-pane" id="deliveredBuynow">
                                                {{#each orders}}
                                                {{#eq this.mode 'buynow'}}
                                                {{#eq this.status 'delivered'}}
                                                <div class="gallery" style="display: inline;">
                                                    <div class="content">
                                                        <img src="/uploads/{{this.productId}}__1.jpg"
                                                            style="width: 100%;" class="card-img-top" alt="...">
                                                        <a href="/productview/{{this.productId}}" class="productview">
                                                            <h5 class="card-title ">{{this.productName}}</h5>
                                                        </a>
                                                        <h3>₹ <span style="color: red;">{{this.productprice}}</span>
                                                        </h3>
                                                        </p>
                                                        <button style="color: white;margin-bottom: 5px;" onclick="redirectToInvoice('{{this._id}}','{{this.productName}}','{{this.productId}}')"  class="buy-3" >View invoice</button>
                                                    </div>
                                                </div>
                                                {{else}}
                                                {{!-- Error Image --}}
                                                <img src="" alt="">
                                                {{/eq}}
                                                {{else}}
                                                {{#each this.products}}
                                                {{#eq this.status 'delivered'}}
                                                <div class="gallery" style="display: inline;">
                                                    <div class="content">
                                                        <img src="/uploads/{{this.item}}__1.jpg" style="width: 100%;"
                                                            class="card-img-top" alt="...">
                                                        <a href="/productview/{{this.item}}" class="productview">
                                                            <h5 class="card-title ">{{this.name}}</h5>
                                                        </a>
                                                        <h3>₹ <span style="color: red;">{{this.price}}</span></h3>
                                                        <button style="color: white;margin-bottom: 5px;" onclick="redirectToInvoice('{{../this._id}}','{{this.name}}','{{this.item}}')"
                                                            class="buy-3">View invoice</button>
                                                    </div>
                                                </div>
                                                {{else}}
                                                {{!-- Error Image --}}
                                                <img src="" alt="">
                                                {{/eq}}
                                                {{/each}}
                                                {{/eq}}
                                                {{/each}}
                                            </div>


                                            <div role="tabpanel" class="tab-pane" id="cancelBuynow">
                                                {{#each orders}}
                                                {{#eq this.mode 'buynow'}}
                                                {{#eq this.status 'cancel'}}

                                                <div class="gallery" style="display: inline;">
                                                    <div class="content">
                                                        <img src="/uploads/{{this.productId}}__1.jpg"
                                                            style="width: 100%;" class="card-img-top" alt="...">
                                                        <a href="/productview/{{this.productId}}" class="productview">
                                                            <h5 class="card-title ">{{this.productName}}</h5>
                                                        </a>
                                                        <h3>₹ <span style="color: red;">{{this.productprice}}</span>
                                                        </h3>

                                                        <h5 style="color: red;">Cancelled</h5>
                                                    </div>
                                                </div>
                                                {{else}}
                                                {{!-- Error Image --}}
                                                <img src="" alt="">
                                                {{/eq}}

                                                {{else}}
                                                {{#each this.products}}
                                                {{#eq this.status 'cancel'}}
                                                <div class="gallery" style="display: inline;">
                                                    <div class="content">
                                                        <img src="/uploads/{{this.item}}__1.jpg" style="width: 100%;"
                                                            class="card-img-top" alt="...">
                                                        <a href="/productview/{{this.item}}" class="productview">
                                                            <h5 class="card-title ">{{this.name}}</h5>
                                                        </a>
                                                        <h3>₹ <span style="color: red;">{{this.price}}</span></h3>
                                                        <h3 style="color: red;">Cancelled</h3>
                                                    </div>
                                                </div>
                                                {{else}}
                                                {{!-- Error Image --}}
                                                <img src="" alt="">
                                                {{/eq}}
                                                {{/each}}
                                                {{/eq}}
                                                {{/each}}
                                            </div>

                                            {{else}}
                                            <center>
                                                <h3 style="color: red;">Sorry Please make some orders !!</h3>
                                                <img src="/images/No orders.svg" alt=""
                                                    style="height: 240px; margin-top: 20px;">
                                            </center>
                                            {{/if}}

                                        </div>
                                    </div>


                                    {{!-- Contents --}}

                                    {{!-- Content End --}}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
</section>

<script>
    function redirectToInvoice(ordId , proName , proId){
        location.href = `/orderinvoice?orderId=${ordId}&proName=${proName}&proId=${proId}`
    }
</script>

<script>
    // user country code for selected option
    let user_country_code = "IN";

    (function () {
        // script https://www.html-code-generator.com/html/drop-down/country-region

        // Get the country name and state name from the imported script.
        let country_list = country_and_states['country'];
        let states_list = country_and_states['states'];

        // creating country name drop-down
        let option = '';
        option += '<option>select country</option>';
        for (let country_code in country_list) {
            // set selected option user country
            let selected = (country_code == user_country_code) ? ' selected' : '';
            option += '<option value="' + country_code + '"' + selected + '>' + country_list[country_code] + '</option>';
        }
        document.getElementById('country').innerHTML = option;

        // creating states name drop-down
        let text_box = '<input type="text" class="input-text" id="state">';
        let state_code_id = document.getElementById("state-code");

        function create_states_dropdown() {
            // get selected country code
            let country_code = document.getElementById("country").value;
            let states = states_list[country_code];
            // invalid country code or no states add textbox
            if (!states) {
                state_code_id.innerHTML = text_box;
                return;
            }
            let option = '';
            if (states.length > 0) {
                option = '<select id="state">\n';
                for (let i = 0; i < states.length; i++) {
                    option += '<option value="' + states[i].code + '">' + states[i].name + '</option>';
                }
                option += '</select>';
            } else {
                // create input textbox if no states 
                option = text_box
            }
            state_code_id.innerHTML = option;
        }

        // country select change event
        const country_select = document.getElementById("country");
        country_select.addEventListener('change', create_states_dropdown);

        create_states_dropdown();
    })();
</script>
<style>
    .productview :hover {
        color: #4267B2;
    }

    .cardbox {
        box-shadow: 10px 10px 95px -2px rgba(0, 0, 0, 0.20);
        -webkit-box-shadow: 10px 10px 95px -2px rgba(0, 0, 0, 0.20);
        -moz-box-shadow: 10px 10px 95px -2px rgba(0, 0, 0, 0.20);
    }

    input[type="file"] {
        display: none;
    }

    #edit_img {
        margin-left: 0px;
        color: white;
        font-size: large;
    }

    * {
        margin: 0;
        padding: 0;
        border: 0;
    }

    /* relevant styles */
    .img__wrap {
        position: relative;
        height: 180px;
        width: 150px;
        border-radius: 100px;
    }

    .img__description {
        position: absolute;
        top: 0;
        bottom: 0;
        left: 0;
        right: 0;
        justify-content: center;
        background: #000000b8;
        border-radius: 100px;
        color: #fff;
        visibility: hidden;
        opacity: 0;

        /* transition effect. not necessary */
        transition: opacity .2s, visibility .2s;
    }

    .img__wrap:hover .img__description {
        visibility: visible;
        opacity: 1;
    }

    .my-account-area {
        padding: 54px 0 120px;
    }

    .my-account-title {
        color: #555555;
        font-size: 18px;
        letter-spacing: 0;
        margin: 0 0 23px;
        position: relative;
        text-transform: uppercase;
    }

    .my-account-title::after {
        background: #ed1d7f none repeat scroll 0 0;
        bottom: -22px;
        content: "";
        height: 3px;
        left: 0;
        position: absolute;
        width: 30px;
        z-index: 2;
    }

    .my-account-welcome {}

    .my-account-welcome ul {
        list-style: outside none none;
        padding: 0;
    }

    .my-account-welcome ul li {}

    .my-account-welcome ul li a {
        color: #555555;
        font-size: 15px;
        font-weight: 300;
        letter-spacing: 0;
        line-height: 72px;
    }

    .personal-information {}

    .personal-information-box {
        margin: 51px 0 0;
    }

    .pib-item {
        margin: 0 0 28px;
    }

    .pib-item label {
        color: #555555;
        display: block;
        font-size: 15px;
        font-weight: 300;
        letter-spacing: 0;
        line-height: 17px;
        margin: 0 0 17px;
        text-transform: capitalize;
    }

    .pib-item input[type="text"],
    .pib-item select {
        border: 1px solid #dddddd;
        color: #b7b7b7;
        font-size: 14px;
        font-weight: 300;
        height: 50px;
        letter-spacing: 0;
        padding: 0 10px;
        width: 100%;
    }

    .pib-item.pib-item-date select {
        display: inline-block;
        margin-left: 3.3%;
        width: 30%;
    }

    .pib-item.pib-item-date select.bd-month {
        margin-left: 0;
    }

    .pib-item.pib-item-date select.bd-date {}

    .pib-item.pib-item-date select.bd-year {}

    .pib-save-change {
        margin: 32px 0 0;
        text-align: right;
    }

    .pib-save-change button {
        background: #ed1d1d none repeat scroll 0 0;
        border: 0 none;
        border-radius: 3px;
        color: #fff;
        display: inline-block;
        font-size: 14px;
        letter-spacing: 0;
        padding: 5px 30px;
        text-transform: uppercase;
    }
</style>

<style type="text/css">
    .gallery {
        display: flex;
        flex-wrap: wrap;
        justify-content: left;
        width: 100%;
    }

    .content {
        width: 24%;
        margin: 15px;
        box-sizing: border-box;
        float: left;
        text-align: center;
        border-radius: 10px;
        border-top-right-radius: 10px;
        border-bottom-right-radius: 10px;
        padding-top: 10px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        transition: .4s;
    }

    .content:hover {
        box-shadow: 0 0 11px rgba(33, 33, 33, .2);
        transform: translate(0px, -8px);
        transition: .6s;
    }

    button {
        text-align: center;
        font-size: 24px;
        color: #fff;
        width: 100%;
        padding: 15px;
        border: 0px;
        outline: none;
        cursor: pointer;
        margin-top: 5px;
        border-bottom-right-radius: 10px;
        border-bottom-left-radius: 10px;
    }

    .buy-1 {
        font-size: large;
        background-color: #ec1000;
    }

    .buy-2 {
        font-size: large;
        background-color: #3b3e6e;
    }

    .buy-3 {
        font-size: large;
        background-color: #0b0b0b;
    }

    @media(max-width: 1000px) {
        .content {
            width: 46%;
        }
    }

    @media(max-width: 750px) {
        .content {
            width: 100%;
        }
    }
</style>