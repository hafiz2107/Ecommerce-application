<section id="page-title" class="page-title">
    <div class="my-account-area">
        <div class="container">
            <div class="row">
                {{>user-ordersnav}}
                <div class="col-md-9">
                    <div class="personal-information">
                        <h4 class="my-account-title">Your Orders</h4>
                        <div class="personal-information-box">
                            <div class="row">

                                {{!-- Contents --}}
                        {{#if orders}}
                            {{#each orders}}
                                <div class="card col-sm-6 col-md-6 col-lg-4 col-xl-4 mt-4 cardbox"
                                    style="width: 18rem;margin-top: 15px;border-radius: 10px;">
                                    <img src="/uploads/{{this.products._id}}__1.jpg" style="width: 100%;"
                                        class="card-img-top" alt="...">
                                    <div class="card-body text-center" style="margin-top: 15px;">
                                        <hr>
                                        <a href="/productview/{{this.products._id}}" class="productview">
                                            <h5 class="card-title ">{{this.products.productname}}</h5>
                                        </a>
                                        <hr>
                                        <h5>â‚¹ <span style="color: red;">{{this.products.productprice}}</span></h5>
                                        <hr>
                                        <p>Ordered Date : {{this.orderDate}}</p>
                                        {{#eq this.status 'placed'}}
                                        <button class="btn btn-danger" data-toggle="modal"
                                            data-target="#{{this.products._id}}11"
                                            style="color: white;margin-bottom: 5px;">Cancel Order</button>

                                        <!-- Modal for order cancel for order placed -->
                                        <div class="modal fade" id="{{this.products._id}}11" tabindex="-1" role="dialog"
                                            aria-labelledby="exampleModalLabel" aria-hidden="true">
                                            <div class="modal-dialog" role="document">
                                                <div class="modal-content">
                                                    <div class="modal-header">
                                                        <h3 class="modal-title" style="color: red;"
                                                            id="exampleModalLabel">Cancel Order</h3>
                                                        <button type="button" class="close" data-dismiss="modal"
                                                            aria-label="Close">
                                                            <span aria-hidden="true">&times;</span>
                                                        </button>
                                                    </div>
                                                    <div class="modal-body">
                                                        <h5>Are you sure you want to cancel the order ? </h5>
                                                        <p>Once done cannot be reversed !</p>
                                                    </div>
                                                    <div class="modal-footer">
                                                        <button type="button" class="btn btn-success"
                                                            data-dismiss="modal">Cancel</button>
                                                        <button type="button"
                                                            onclick="deleteCartItem('{{this._id}}','{{this.product._id}}')"
                                                            class="btn btn-danger" style="width: 70px;">Ok</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        {{!-- Modal End --}}

                                        {{/eq}}

                                        {{!-- Checking status shipped --}}
                                        {{#eq this.status 'shipped'}}
                                        <button class="btn btn-danger" data-toggle="modal"
                                            data-target="#{{this.products._id}}11"
                                            style="color: white;margin-bottom: 5px;">Cancel Order</button>
                                        <!-- Modal  for order cancel confirmation-->
                                        <div class="modal fade" id="{{this.products._id}}11" tabindex="-1" role="dialog"
                                            aria-labelledby="exampleModalLabel" aria-hidden="true">
                                            <div class="modal-dialog" role="document">
                                                <div class="modal-content">
                                                    <div class="modal-header">
                                                        <h3 class="modal-title" style="color: red;"
                                                            id="exampleModalLabel">Cancel Order</h3>
                                                        <button type="button" class="close" data-dismiss="modal"
                                                            aria-label="Close">
                                                            <span aria-hidden="true">&times;</span>
                                                        </button>
                                                    </div>
                                                    <div class="modal-body">
                                                        <h5>Are you sure you want to cancel the order ? </h5>
                                                        <p>Once done cannot be reversed !</p>
                                                    </div>
                                                    <div class="modal-footer">
                                                        <button type="button" class="btn btn-success"
                                                            data-dismiss="modal">Cancel</button>
                                                        <button type="button"
                                                            onclick="deleteCartItem('{{this._id}}','{{this.product._id}}')"
                                                            class="btn btn-danger" style="width: 70px;">Ok</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        {{!-- Modal end --}}
                                        {{/eq}}

                                        {{#eq this.status 'delivered'}}
                                       
                                        <a href="/orderinvoice?orderId={{this._id}}" class="btn btn-danger" style="color: white;margin-bottom: 5px;">View invoice</a>
                                        {{/eq}}

                                    </div>
                                </div>
                                {{/each}}
                                {{else}}
                                <center>
                                    <h3 style="color: red;">Sorry Please make some orders !!</h3>
                                    <img src="/images/No orders.svg" alt="" style="height: 240px; margin-top: 20px;">
                                </center>
                                {{/if}}
                                {{!-- Content End --}}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>


<script>
    // user country code for selected option
    let user_country_code = "IN";

    (function () {
        // script https://www.html-code-generator.com/html/drop-down/country-region

        // Get the country name and state name from the imported script.
        let country_list = country_and_states['country'];
        let states_list = country_and_states['states'];

        // creating country name drop-down
        let option = '';
        option += '<option>select country</option>';
        for (let country_code in country_list) {
            // set selected option user country
            let selected = (country_code == user_country_code) ? ' selected' : '';
            option += '<option value="' + country_code + '"' + selected + '>' + country_list[country_code] + '</option>';
        }
        document.getElementById('country').innerHTML = option;

        // creating states name drop-down
        let text_box = '<input type="text" class="input-text" id="state">';
        let state_code_id = document.getElementById("state-code");

        function create_states_dropdown() {
            // get selected country code
            let country_code = document.getElementById("country").value;
            let states = states_list[country_code];
            // invalid country code or no states add textbox
            if (!states) {
                state_code_id.innerHTML = text_box;
                return;
            }
            let option = '';
            if (states.length > 0) {
                option = '<select id="state">\n';
                for (let i = 0; i < states.length; i++) {
                    option += '<option value="' + states[i].code + '">' + states[i].name + '</option>';
                }
                option += '</select>';
            } else {
                // create input textbox if no states 
                option = text_box
            }
            state_code_id.innerHTML = option;
        }

        // country select change event
        const country_select = document.getElementById("country");
        country_select.addEventListener('change', create_states_dropdown);

        create_states_dropdown();
    })();
</script>
<style>
    .productview :hover {
        color: #4267B2;
    }

    .cardbox {
        box-shadow: 10px 10px 95px -2px rgba(0, 0, 0, 0.20);
        -webkit-box-shadow: 10px 10px 95px -2px rgba(0, 0, 0, 0.20);
        -moz-box-shadow: 10px 10px 95px -2px rgba(0, 0, 0, 0.20);
    }

    input[type="file"] {
        display: none;
    }

    #edit_img {
        margin-left: 0px;
        color: white;
        font-size: large;
    }

    * {
        margin: 0;
        padding: 0;
        border: 0;
    }

    /* relevant styles */
    .img__wrap {
        position: relative;
        height: 180px;
        width: 150px;
        border-radius: 100px;
    }

    .img__description {
        position: absolute;
        top: 0;
        bottom: 0;
        left: 0;
        right: 0;
        justify-content: center;
        background: #000000b8;
        border-radius: 100px;
        color: #fff;
        visibility: hidden;
        opacity: 0;

        /* transition effect. not necessary */
        transition: opacity .2s, visibility .2s;
    }

    .img__wrap:hover .img__description {
        visibility: visible;
        opacity: 1;
    }

    .my-account-area {
        padding: 54px 0 120px;
    }

    .my-account-title {
        color: #555555;
        font-size: 18px;
        letter-spacing: 0;
        margin: 0 0 23px;
        position: relative;
        text-transform: uppercase;
    }

    .my-account-title::after {
        background: #ed1d7f none repeat scroll 0 0;
        bottom: -22px;
        content: "";
        height: 3px;
        left: 0;
        position: absolute;
        width: 30px;
        z-index: 2;
    }

    .my-account-welcome {}

    .my-account-welcome ul {
        list-style: outside none none;
        padding: 0;
    }

    .my-account-welcome ul li {}

    .my-account-welcome ul li a {
        color: #555555;
        font-size: 15px;
        font-weight: 300;
        letter-spacing: 0;
        line-height: 72px;
    }

    .personal-information {}

    .personal-information-box {
        margin: 51px 0 0;
    }

    .pib-item {
        margin: 0 0 28px;
    }

    .pib-item label {
        color: #555555;
        display: block;
        font-size: 15px;
        font-weight: 300;
        letter-spacing: 0;
        line-height: 17px;
        margin: 0 0 17px;
        text-transform: capitalize;
    }

    .pib-item input[type="text"],
    .pib-item select {
        border: 1px solid #dddddd;
        color: #b7b7b7;
        font-size: 14px;
        font-weight: 300;
        height: 50px;
        letter-spacing: 0;
        padding: 0 10px;
        width: 100%;
    }

    .pib-item.pib-item-date select {
        display: inline-block;
        margin-left: 3.3%;
        width: 30%;
    }

    .pib-item.pib-item-date select.bd-month {
        margin-left: 0;
    }

    .pib-item.pib-item-date select.bd-date {}

    .pib-item.pib-item-date select.bd-year {}

    .pib-save-change {
        margin: 32px 0 0;
        text-align: right;
    }

    .pib-save-change button {
        background: #ed1d1d none repeat scroll 0 0;
        border: 0 none;
        border-radius: 3px;
        color: #fff;
        display: inline-block;
        font-size: 14px;
        letter-spacing: 0;
        padding: 5px 30px;
        text-transform: uppercase;
    }
</style>